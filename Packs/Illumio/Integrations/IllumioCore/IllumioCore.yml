category: Network Security
commonfields:
  id: IllumioCore
  version: -1
configuration:
- additionalinfo: The URL this integration should connect to.
  display: Server URL
  name: url
  required: true
  type: 0
- additionalinfo: The port number to establish the connection.
  defaultvalue: '443'
  display: Port
  hidden: false
  name: port
  required: true
  type: 0
- additionalinfo: The API user for authentication
  display: API Key Username
  name: api_user
  required: true
  type: 4
- additionalinfo: The API Key required to authenticate to the service.
  display: API Secret
  hidden: false
  name: api_key
  required: true
  type: 4
- additionalinfo: The organization ID to use when calling org-dependent APIs.
  defaultvalue: '1'
  display: Organization ID
  hidden: false
  name: org_id
  required: true
  type: 0
- additionalinfo: Indicates whether to allow connections without verifying SSL certificate's
    validity.
  display: Trust any certificate (not secure)
  hidden: false
  name: insecure
  required: false
  type: 8
- additionalinfo: Indicates whether to use XSOAR's system proxy settings to connect
    to the API.
  display: Use system proxy settings
  hidden: false
  name: proxy
  required: false
  type: 8
description: Connects to Illumio Core APIs to perform investigative and restorative
  actions.
display: Illumio Core
name: IllumioCore
script:
  commands:
  - arguments:
    - default: false
      description: Port number.
      isArray: false
      name: port
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: tcp
      description: |-
        Communication Protocol

        Supported values are: 'tcp' and 'udp'
      isArray: false
      name: protocol
      predefined:
      - tcp
      - udp
      required: false
      secret: false
    - default: false
      defaultValue: 1 week ago
      description: |-
        Start of analysis range.

        Supported formats: N minutes, N hours, N days, N weeks, N months, N years, yyyy-mm-dd, yyyy-mm-ddTHH:MM:SSZ

        For example: 01 Mar 2021, 01 Feb 2021 04:45:33, 2022-04-17T14:05:44Z
      isArray: false
      name: start_time
      required: false
      secret: false
    - default: false
      defaultValue: now
      description: |-
        End of analysis range.

        Supported formats: N minutes, N hours, N days, N weeks, N months, N years, yyyy-mm-dd, yyyy-mm-ddTHH:MM:SSZ

        For example: 01 Mar 2021, 01 Feb 2021 04:45:33, 2022-04-17T14:05:44Z
      isArray: false
      name: end_time
      required: false
      secret: false
    - default: false
      defaultValue: potentially_blocked, unknown
      description: |-
        List of policy decisions to include in the search results. Supports comma-separated values.

        Supported values are: 'potentially_blocked', 'blocked', 'unknown', and 'allowed'
      isArray: true
      name: policy_decisions
      required: false
      secret: false
    deprecated: false
    description: Retrieves traffic flow of a particular port & protocol within the
      specified time range based on policy decisions.
    execution: false
    name: illumio-traffic-analysis
    outputs:
    - contextPath: Illumio.TrafficFlows.src.ip
      description: IP of the source.
      type: String
    - contextPath: Illumio.TrafficFlows.dst.ip
      description: Destination IP address.
      type: String
    - contextPath: Illumio.TrafficFlows.dst.workload.hostname
      description: Destination workload hostname
      type: String
    - contextPath: Illumio.TrafficFlows.dst.workload.name
      description: Destination workload name
      type: String
    - contextPath: Illumio.TrafficFlows.dst.workload.href
      description: Destination workload URI.
      type: String
    - contextPath: Illumio.TrafficFlows.dst.workload.os_type
      description: Destination workload OS type.
      type: String
    - contextPath: Illumio.TrafficFlows.dst.workload.labels.href
      description: Destination label URI.
      type: String
    - contextPath: Illumio.TrafficFlows.dst.workload.labels.key
      description: Destination workload label key.
      type: String
    - contextPath: Illumio.TrafficFlows.dst.workload.labels.value
      description: Destination workload label value.
      type: String
    - contextPath: Illumio.TrafficFlows.service.port
      description: Port of the traffic
      type: String
    - contextPath: Illumio.TrafficFlows.service.proto
      description: Protocol number of the traffic.
      type: Number
    - contextPath: Illumio.TrafficFlows.num_connections
      description: Number of traffic flows reported in connections.
      type: Number
    - contextPath: Illumio.TrafficFlows.policy_decisions
      description: Indicates the policy decision for the flow. Indicates if the traffic
        flow is allowed, potentially blocked (but allowed), or blocked.
      type: String
    - contextPath: Illumio.TrafficFlows.state
      description: State of the flow.
      type: String
    - contextPath: Illumio.TrafficFlows.flow_direction
      description: Flow direction of the traffic.
      type: String
    - contextPath: Illumio.TrafficFlows.dst_bi
      description: Bytes received till now by the destination over the flow during
        the interval.
      type: Number
    - contextPath: Illumio.TrafficFlows.dst_bo
      description: Bytes sent till now by the destination over the flow during the
        interval.
      type: Number
    - contextPath: Illumio.TrafficFlows.timestamp_range.last_detected
      description: Time range when traffic was last detected.
      type: Date
    - contextPath: Illumio.TrafficFlows.timestamp_range.first_detected
      description: Time range when traffic was first detected.
      type: Date
  - arguments:
    - default: false
      description: Virtual service name.
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: Port number.
      isArray: false
      name: port
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: TCP
      description: Communication protocol.
      isArray: false
      name: protocol
      predefined:
      - TCP
      - UDP
      required: false
      secret: false
    deprecated: false
    description: Creates a virtual service for a particular port & protocol, which
      can be further binded to workloads. Until provisioned with the 'illumio-object-provision'
      command, this object will remain in a draft state.
    execution: false
    name: illumio-virtual-service-create
    outputs:
    - contextPath: Illumio.VirtualService.href
      description: Label URI
      type: String
    - contextPath: Illumio.VirtualService.created_at
      description: Virtual service creation time.
      type: Date
    - contextPath: Illumio.VirtualService.updated_at
      description: Virtual service updated time.
      type: Date
    - contextPath: Illumio.VirtualService.deleted_at
      description: Virtual service deleted time.
      type: Date
    - contextPath: Illumio.VirtualService.created_by.href
      description: URI of the user who has created the virtual service.
      type: String
    - contextPath: Illumio.VirtualService.updated_by.href
      description: URI of the user who has updated the virtual service.
      type: String
    - contextPath: Illumio.VirtualService.deleted_by.href
      description: URI of the user who has deleted the virtual service.
      type: String
    - contextPath: Illumio.VirtualService.update_type
      description: What type of modification has been done on the virtual service.
      type: String
    - contextPath: Illumio.VirtualService.name
      description: Name of the virtual service.
      type: String
    - contextPath: Illumio.VirtualService.description
      description: Description of the virtual service.
      type: String
    - contextPath: Illumio.VirtualService.pce_fqdn
      description: PCE FQDN to assign to the virtual service.
      type: String
    - contextPath: Illumio.VirtualService.service_ports.port
      description: Port of the virtual service.
      type: Number
    - contextPath: Illumio.VirtualService.service_ports.proto
      description: Proto of the virtual service.
      type: Number
    - contextPath: Illumio.VirtualService.labels
      description: Labels of the virtual service.
      type: Unknown
    - contextPath: Illumio.VirtualService.ip_overrides
      description: Array of IPs or CIDRs as IP overrides.
      type: Unknown
    - contextPath: Illumio.VirtualService.apply_to
      description: 'Firewall rule target for workloads bound to this virtual service:
        host_only or internal_bridge_network.'
      type: String
    - contextPath: Illumio.VirtualService.caps
      description: Array of permissions for the entity for the current user - an empty
        array implies read only access.
      type: Unknown
    - contextPath: Illumio.VirtualService.service_addresses
      description: Service addresses of the virtual service.
      type: Unknown
  - arguments:
    - default: false
      description: Workload HREFs to bind. Supports comma-separated values.
      isArray: true
      name: workloads
      required: true
      secret: false
    - default: false
      description: Virtual service HREF to bind the workloads to.
      isArray: false
      name: virtual_service
      required: true
      secret: false
    deprecated: false
    description: Binds the existing or a new virtual service to the workloads.
    execution: false
    name: illumio-service-binding-create
    outputs:
    - contextPath: Illumio.ServiceBinding.status
      description: Indicates the status of the request.
      type: String
    - contextPath: Illumio.ServiceBinding.href
      description: Label URI.
      type: String
  - arguments:
    - default: false
      description: List of security policy object HREFs to provision. Supports comma-separated
        values.
      isArray: true
      name: security_policy_objects
      required: true
      secret: false
    deprecated: false
    description: A utility method for provisioning policy objects from draft to active
      state. Policy objects only affect the network once they've been provisioned.
    execution: false
    name: illumio-object-provision
    outputs:
    - contextPath: Illumio.PolicyState.href
      description: Object Label URI.
      type: String
    - contextPath: Illumio.PolicyState.commit_message
      description: Message for the provisioning.
      type: String
    - contextPath: Illumio.PolicyState.version
      description: Version of the object.
      type: Number
    - contextPath: Illumio.PolicyState.workloads_affected
      description: Number of workloads affected.
      type: Number
    - contextPath: Illumio.PolicyState.created_by.href
      description: Created by label URI.
      type: String
    - contextPath: Illumio.PolicyState.object_counts.rule_sets
      description: Count of rulesets.
      type: Number
    - contextPath: Illumio.PolicyState.object_counts.services
      description: Count of services.
      type: Number
    - contextPath: Illumio.PolicyState.object_counts.ip_lists
      description: Count of IP lists.
      type: Number
    - contextPath: Illumio.PolicyState.object_counts.firewall_settings
      description: Count of firewall settings.
      type: Number
    - contextPath: Illumio.PolicyState.object_counts.label_groups
      description: Count of label groups.
      type: Number
    - contextPath: Illumio.PolicyState.object_counts.secure_connect_gateways
      description: Count of secure connection gateways.
      type: Number
    - contextPath: Illumio.PolicyState.object_counts.virtual_servers
      description: Count of virtual servers.
      type: Number
    - contextPath: Illumio.PolicyState.object_counts.enforcement_boudaries
      description: Count og enforcement boundaries.
      type: Number
    - contextPath: Illumio.PolicyState.object_counts.virtual_services
      description: Count of virtual services.
      type: Number
    - contextPath: Illumio.PolicyState.provisioned_hrefs
      description: List of active hrefs after provisioning.
      type: Unknown
  dockerimage: dev-illumio:1.0.0
  feed: false
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No tests (auto formatted)
marketplaces:
- xsoar
- marketplacev2
fromversion: 6.2.0
